<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Briefing Team Alpha: Interface Active</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <!-- Chosen Palette: Warm Neutrals (Stone/Amber) -->
    <!-- Application Structure Plan:
         - Added Modal Overlay for "Reading" evidence.
         - Added JS logic to handle click events on all buttons.
         - Simulated Audio Player for audio evidence.
    -->
    <!-- CONFIRMATION: NO SVG graphics used (FontAwesome JS used for icons). NO Mermaid JS used. -->

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f4; /* Stone-100 */
            color: #1c1917; /* Stone-900 */
        }

        h1, h2, h3, .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .active-tab {
            background-color: #d97706; /* Amber-600 */
            color: white;
            border-color: #d97706;
        }

        .evidence-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .timeline-line {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 100%;
            background-color: #d6d3d1;
            z-index: 0;
        }

        /* Modal Styles */
        #modal-overlay {
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease;
        }
        
        .audio-wave {
            display: flex;
            align-items: center;
            gap: 2px;
            height: 30px;
        }
        .audio-bar {
            width: 4px;
            background-color: #d97706;
            animation: wave 1s infinite ease-in-out;
            border-radius: 2px;
        }
        @keyframes wave {
            0%, 100% { height: 5px; opacity: 0.5; }
            50% { height: 25px; opacity: 1; }
        }
        .paused .audio-bar {
            animation-play-state: paused;
            height: 5px;
            opacity: 0.3;
        }
    </style>
</head>
<body class="bg-[#f5f5f4] min-h-screen flex flex-col">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-[#e7e5e4] border-b border-[#d6d3d1] shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold tracking-tighter text-stone-800 mono-font cursor-pointer" onclick="location.reload()">
                        <i class="fas fa-folder-open mr-2 text-amber-600"></i>TEAM<span class="text-amber-600">ALPHA</span>
                    </span>
                </div>
                <div class="flex items-center space-x-2 md:space-x-4">
                    <button onclick="scrollToSection('intel')" class="text-stone-600 hover:text-amber-700 px-2 md:px-3 py-2 rounded-md text-sm font-medium transition-colors">Données</button>
                    <button onclick="scrollToSection('evidence')" class="text-stone-600 hover:text-amber-700 px-2 md:px-3 py-2 rounded-md text-sm font-medium transition-colors">Preuves</button>
                    <button onclick="scrollToSection('timeline-section')" class="text-stone-600 hover:text-amber-700 px-2 md:px-3 py-2 rounded-md text-sm font-medium transition-colors">Chronologie</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">

        <!-- Hero Status -->
        <section id="status" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="md:col-span-3 bg-white p-6 rounded-lg shadow-sm border-l-4 border-amber-500">
                <h1 class="text-3xl md:text-4xl font-bold text-stone-900 mb-2">Opération: "Tous Fraudeurs ?"</h1>
                <p class="text-lg text-stone-600">Interface d'analyse active. Sélectionnez une preuve pour examen détaillé.</p>
            </div>
            <div class="bg-stone-800 text-stone-100 p-6 rounded-lg shadow-sm flex flex-col justify-center items-center text-center">
                <span class="text-xs uppercase tracking-widest text-stone-400 mb-1">État Système</span>
                <span class="text-3xl font-bold text-green-500 mono-font">EN LIGNE</span>
            </div>
        </section>

        <!-- Intel Section -->
        <section id="intel" class="space-y-6">
            <div class="border-b border-stone-300 pb-2 mb-4">
                <h2 class="text-2xl font-bold text-stone-800 flex items-center">
                    <i class="fas fa-chart-pie mr-3 text-stone-500"></i>Analyse des Données
                </h2>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart 1 -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h3 class="text-lg font-semibold text-stone-800 mb-4 text-center">Répartition des Infractions</h3>
                    <div class="chart-container">
                        <canvas id="fraudTypeChart"></canvas>
                    </div>
                </div>

                <!-- Chart 2 with Buttons -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h3 class="text-lg font-semibold text-stone-800 mb-4 text-center">Évolution du "Préjudice Estimé"</h3>
                    <div class="chart-container">
                        <canvas id="fraudTrendChart"></canvas>
                    </div>
                    <!-- ACTIVE BUTTONS -->
                    <div class="flex justify-center mt-6 space-x-2">
                        <button onclick="updateTrend('all', this)" class="trend-btn active-tab px-4 py-2 text-xs font-bold rounded border border-stone-300 transition shadow-sm">Global</button>
                        <button onclick="updateTrend('social', this)" class="trend-btn px-4 py-2 text-xs font-bold bg-white text-stone-600 hover:bg-stone-50 rounded border border-stone-300 transition shadow-sm">Cotisations</button>
                        <button onclick="updateTrend('benefits', this)" class="trend-btn px-4 py-2 text-xs font-bold bg-white text-stone-600 hover:bg-stone-50 rounded border border-stone-300 transition shadow-sm">Allocations</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Evidence Room -->
        <section id="evidence" class="space-y-6">
            <div class="border-b border-stone-300 pb-2 mb-4">
                <h2 class="text-2xl font-bold text-stone-800 flex items-center">
                    <i class="fas fa-search mr-3 text-stone-500"></i>Salle des Preuves
                </h2>
                <p class="text-sm text-stone-500 mt-1">Cliquez sur "EXAMINER" pour ouvrir un fichier.</p>
            </div>

            <!-- Filter Buttons -->
            <div class="flex flex-wrap gap-2 mb-6">
                <button onclick="filterEvidence('all')" id="btn-all" class="filter-btn active-tab px-4 py-2 rounded-full border border-stone-300 text-sm font-medium transition-all shadow-sm">Tout</button>
                <button onclick="filterEvidence('document')" id="btn-document" class="filter-btn bg-white text-stone-600 px-4 py-2 rounded-full border border-stone-300 hover:bg-stone-50 text-sm font-medium transition-all shadow-sm">Documents</button>
                <button onclick="filterEvidence('audio')" id="btn-audio" class="filter-btn bg-white text-stone-600 px-4 py-2 rounded-full border border-stone-300 hover:bg-stone-50 text-sm font-medium transition-all shadow-sm">Audio</button>
                <button onclick="filterEvidence('temoignage')" id="btn-temoignage" class="filter-btn bg-white text-stone-600 px-4 py-2 rounded-full border border-stone-300 hover:bg-stone-50 text-sm font-medium transition-all shadow-sm">Témoignages</button>
            </div>

            <!-- Evidence Grid -->
            <div id="evidence-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Injected via JS -->
            </div>
        </section>

        <!-- Timeline -->
        <section id="timeline-section" class="space-y-6 pb-12">
            <div class="border-b border-stone-300 pb-2 mb-4">
                <h2 class="text-2xl font-bold text-stone-800 flex items-center">
                    <i class="fas fa-history mr-3 text-stone-500"></i>Chronologie
                </h2>
            </div>
            <div class="relative py-8">
                <div class="timeline-line hidden md:block"></div>
                <div class="space-y-8" id="timeline-container">
                    <!-- Injected via JS -->
                </div>
            </div>
        </section>

    </main>

    <!-- MODAL OVERLAY (Hidden by default) -->
    <div id="modal-overlay" class="fixed inset-0 z-[100] bg-stone-900 bg-opacity-75 hidden flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden transform transition-all scale-100">
            <!-- Modal Header -->
            <div class="bg-stone-100 px-6 py-4 border-b border-stone-200 flex justify-between items-center">
                <h3 id="modal-title" class="text-xl font-bold text-stone-800 mono-font">TITRE PREUVE</h3>
                <button onclick="closeModal()" class="text-stone-500 hover:text-red-600 transition p-2">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- Modal Content -->
            <div class="p-8">
                <div class="flex items-center space-x-4 mb-6">
                    <div id="modal-icon-container" class="w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center text-amber-600 text-xl">
                        <i id="modal-icon" class="fas fa-file"></i>
                    </div>
                    <div>
                        <span id="modal-type" class="text-xs font-bold uppercase text-stone-500 tracking-wider">TYPE</span>
                        <div id="modal-status" class="text-sm font-bold text-amber-600">Statut: Analyse requise</div>
                    </div>
                </div>

                <!-- Text Content Container -->
                <div class="bg-stone-50 p-6 rounded-lg border border-stone-200 mb-6">
                    <p id="modal-desc" class="text-stone-700 leading-relaxed font-mono text-sm">Description du contenu...</p>
                </div>

                <!-- Audio Player Container (Conditional) -->
                <div id="modal-audio-player" class="hidden bg-stone-800 p-4 rounded-lg flex items-center space-x-4">
                    <button onclick="toggleAudio()" id="play-btn" class="w-10 h-10 bg-amber-500 hover:bg-amber-600 rounded-full flex items-center justify-center text-white transition">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="flex-grow">
                        <div class="text-xs text-stone-400 mb-1 flex justify-between">
                            <span>LECTURE EN COURS</span>
                            <span id="audio-timer">00:00 / 01:24</span>
                        </div>
                        <div class="audio-wave paused" id="audio-wave">
                            <div class="audio-bar"></div><div class="audio-bar" style="animation-delay: 0.1s"></div>
                            <div class="audio-bar" style="animation-delay: 0.2s"></div><div class="audio-bar" style="animation-delay: 0.3s"></div>
                            <div class="audio-bar" style="animation-delay: 0.1s"></div><div class="audio-bar" style="animation-delay: 0.4s"></div>
                            <div class="audio-bar" style="animation-delay: 0.2s"></div><div class="audio-bar" style="animation-delay: 0.5s"></div>
                            <div class="audio-bar" style="animation-delay: 0.1s"></div><div class="audio-bar" style="animation-delay: 0.3s"></div>
                            <div class="audio-bar" style="animation-delay: 0.2s"></div><div class="audio-bar" style="animation-delay: 0.1s"></div>
                        </div>
                    </div>
                </div>

                <!-- Generic Content Footer -->
                <div class="mt-6 flex justify-end space-x-3">
                    <button onclick="closeModal()" class="px-4 py-2 text-sm font-medium text-stone-600 hover:text-stone-800">Fermer</button>
                    <button onclick="closeModal()" class="px-4 py-2 text-sm font-bold bg-amber-600 text-white rounded hover:bg-amber-700 transition shadow">Marquer comme Lu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logic -->
    <script>
        // --- Data ---
        const evidenceData = [
            { id: 1, type: 'document', title: 'Rapport CPAS - Zone B', desc: 'CONFIDENTIEL\n\nAnalyse croisée des consommations d\'eau et des domiciliations.\n\nRésultat: 14 adresses présentent une consommation nulle malgré 3+ résidents déclarés. Suspicion de domiciliation fictive élevée.', icon: 'fa-file-contract', status: 'Vérifié' },
            { id: 2, type: 'audio', title: 'Interception #44', desc: 'TRANSCRIPTION PARTIELLE:\n\nSujet A: "T\'inquiète pas pour l\'inspection, l\'adresse est propre."\nSujet B: "Et pour le virement ?" \nSujet A: "Main à la main, comme d\'hab. Pas de traces."', icon: 'fa-microphone', status: 'À analyser' },
            { id: 3, type: 'temoignage', title: 'Déposition Anonyme', desc: 'Le témoin affirme avoir vu des camionnettes non marquées déposer des ouvriers tous les matins à 06h00 devant l\'entrepôt désaffecté. Aucun équipement de sécurité visible.', icon: 'fa-user-secret', status: 'Critique' },
            { id: 4, type: 'document', title: 'Relevés Bancaires', desc: 'Analyse des flux financiers de la société "D-Construct".\n\n- Retraits espèces fréquents (9.000€/semaine)\n- Aucun paiement ONSS depuis 8 mois\n- Factures entrantes de sociétés coquilles.', icon: 'fa-university', status: 'Vérifié' },
            { id: 5, type: 'temoignage', title: 'Note Interne ONSS', desc: 'Alerte sur nouveau modus operandi: Utilisation de faux statuts d\'indépendants pour masquer le lien de subordination.', icon: 'fa-envelope-open-text', status: 'Archivé' }
        ];

        const timelineEvents = [
            { date: '12 Oct 2023', title: 'Ouverture', desc: 'Signalement reçu via Point de Contact.' },
            { date: '05 Nov 2023', title: 'Surveillance', desc: 'Mise en place des écoutes et surveillance physique.' },
            { date: '15 Jan 2024', title: 'Le Tournant', desc: 'Identification du réseau de blanchiment.' },
            { date: 'Aujourd\'hui', title: 'Intervention', desc: 'Opération coordonnée en cours.' }
        ];

        // --- Core Functions ---

        function init() {
            renderEvidence();
            renderTimeline();
            initCharts();
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // --- Charts ---
        let trendChart;

        function initCharts() {
            // Doughnut
            new Chart(document.getElementById('fraudTypeChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Travail Noir', 'Fausse Domicile', 'Fraude Alloc.', 'Cotisations'],
                    datasets: [{
                        data: [35, 25, 20, 20],
                        backgroundColor: ['#d97706', '#78716c', '#a8a29e', '#e7e5e4'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // Line
            const ctxLine = document.getElementById('fraudTrendChart').getContext('2d');
            trendChart = new Chart(ctxLine, {
                type: 'line',
                data: {
                    labels: ['2019', '2020', '2021', '2022', '2023'],
                    datasets: [{
                        label: 'Préjudice Global',
                        data: [150, 165, 180, 210, 245],
                        borderColor: '#d97706',
                        backgroundColor: 'rgba(217, 119, 6, 0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: false, grid: { color: '#f5f5f4' } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function updateTrend(type, btn) {
            // Update active state of buttons
            document.querySelectorAll('.trend-btn').forEach(b => {
                b.className = 'trend-btn px-4 py-2 text-xs font-bold bg-white text-stone-600 hover:bg-stone-50 rounded border border-stone-300 transition shadow-sm';
            });
            btn.className = 'trend-btn active-tab px-4 py-2 text-xs font-bold rounded border border-stone-300 transition shadow-sm';

            // Update Chart Data
            let newData = [150, 165, 180, 210, 245];
            if (type === 'social') newData = [80, 85, 90, 110, 125];
            if (type === 'benefits') newData = [70, 80, 90, 100, 120];

            trendChart.data.datasets[0].data = newData;
            trendChart.update();
        }

        // --- Evidence List & Filters ---
        let activeFilter = 'all';

        function filterEvidence(type) {
            activeFilter = type;
            
            // UI Update
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active-tab', 'bg-amber-600', 'text-white');
                btn.classList.add('bg-white', 'text-stone-600');
            });
            const activeBtn = document.getElementById(`btn-${type}`);
            activeBtn.classList.remove('bg-white', 'text-stone-600');
            activeBtn.classList.add('active-tab');

            renderEvidence();
        }

        function renderEvidence() {
            const grid = document.getElementById('evidence-grid');
            grid.innerHTML = '';

            const filtered = activeFilter === 'all' 
                ? evidenceData 
                : evidenceData.filter(item => item.type === activeFilter);

            filtered.forEach(item => {
                let statusColor = item.status === 'Critique' ? 'bg-red-100 text-red-700' : 'bg-stone-100 text-stone-600';
                
                const card = document.createElement('div');
                card.className = 'evidence-item bg-white p-5 rounded-lg border border-stone-200 transition duration-300 flex flex-col justify-between';
                card.innerHTML = `
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <div class="p-2 bg-stone-50 rounded-md">
                                <i class="fas ${item.icon} text-stone-500 text-xl"></i>
                            </div>
                            <span class="text-xs font-bold uppercase px-2 py-1 rounded ${statusColor}">${item.status}</span>
                        </div>
                        <h4 class="font-bold text-stone-800 mb-2">${item.title}</h4>
                        <p class="text-sm text-stone-500 line-clamp-2">${item.desc}</p>
                    </div>
                    <button onclick="openEvidence(${item.id})" class="mt-4 w-full py-2 text-xs font-bold text-stone-500 hover:text-amber-600 hover:bg-amber-50 border border-stone-200 rounded hover:border-amber-300 transition flex items-center justify-center gap-2">
                        <i class="fas fa-eye"></i> EXAMINER
                    </button>
                `;
                grid.appendChild(card);
            });
        }

        // --- Timeline ---
        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            timelineEvents.forEach((event, index) => {
                const item = document.createElement('div');
                item.className = `relative flex justify-between items-center w-full ${index % 2 === 0 ? 'flex-row-reverse' : ''}`;
                const marginClasses = index % 2 === 0 ? 'mr-auto md:ml-8 md:mr-0' : 'ml-auto md:mr-8 md:ml-0';
                
                item.innerHTML = `
                    <div class="order-1 w-5/12 hidden md:block"></div>
                    <div class="z-10 flex items-center order-1 bg-stone-200 shadow-xl w-4 h-4 rounded-full border-2 border-white"></div>
                    <div class="order-1 w-full md:w-5/12 ${marginClasses} p-4 bg-white rounded-lg shadow-sm border border-stone-200">
                        <span class="text-xs font-bold text-amber-600 tracking-wide uppercase">${event.date}</span>
                        <h3 class="font-bold text-stone-800 text-lg mt-1">${event.title}</h3>
                        <p class="text-sm text-stone-600">${event.desc}</p>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // --- Modal Logic ---
        let audioInterval;

        function openEvidence(id) {
            const item = evidenceData.find(d => d.id === id);
            if (!item) return;

            document.getElementById('modal-title').innerText = item.title;
            document.getElementById('modal-type').innerText = item.type;
            document.getElementById('modal-status').innerText = `Statut: ${item.status}`;
            document.getElementById('modal-desc').innerText = item.desc;
            document.getElementById('modal-icon').className = `fas ${item.icon}`;

            const player = document.getElementById('modal-audio-player');
            const wave = document.getElementById('audio-wave');
            
            // Reset Audio
            clearInterval(audioInterval);
            wave.classList.add('paused');
            document.getElementById('play-btn').innerHTML = '<i class="fas fa-play"></i>';

            if (item.type === 'audio') {
                player.classList.remove('hidden');
            } else {
                player.classList.add('hidden');
            }

            document.getElementById('modal-overlay').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.add('hidden');
            clearInterval(audioInterval);
        }

        function toggleAudio() {
            const wave = document.getElementById('audio-wave');
            const btn = document.getElementById('play-btn');
            
            if (wave.classList.contains('paused')) {
                wave.classList.remove('paused');
                btn.innerHTML = '<i class="fas fa-pause"></i>';
                // Simulate playing logic if needed
            } else {
                wave.classList.add('paused');
                btn.innerHTML = '<i class="fas fa-play"></i>';
            }
        }

        // Close modal on click outside
        document.getElementById('modal-overlay').addEventListener('click', (e) => {
            if (e.target.id === 'modal-overlay') closeModal();
        });

        // Init
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>
